
Bayesian A/B Testing
========================================================
author: Alex Yakubovich
date: July 9, 2014
transition: none



Frequentist A/B Testing
========================================================
- **P-value**: Probability of observing the result of a test (or a more extreme one) if there is no effect
- Probability of data given model

----

![Sampling distribution under the null hypothesis](images/p-value.jpeg)


Problems
========================================================
- **No peeking**: unrealistic sample size requirements  
- Makes crude (but valid) approximations.
- Not all mistakes are created equal
- **Inflexible** and hard to interpert

Problems
========================================================
- **No peeking**: unrealistic sample size requirements  
- Makes crude (but valid) approximations.
- Not all mistakes are created equal
- **Inflexible** and hard to interpert

![One does not simply](images/one-does-not-simply-explain.png)

The Bayesian approach
========================================================
- Compute the **probability of the model given the data**
![plot of chunk unnamed-chunk-2](bayesian-ab-testing-lnl-figure/unnamed-chunk-2.png) 




Prior Distribution
========================================================
Beliefs about a random variable before seeing the data.
![plot of chunk unnamed-chunk-3](bayesian-ab-testing-lnl-figure/unnamed-chunk-3.png) 

Beta Distribution
========================================================
![Beta distribution](images/beta-dist.png)

Likelihood Function
========================================================

Measures how likely it is that the data $D$ was generated by the model.
![Likelihood](images/likelihood.png)

Bayes Rule
========================================================

Tells us how to update our beliefs after seeing the data.

$$ P(W | D) \propto P(D|W) \times P (W)$$

* $W =$ world state 
* $D =$ observed data

Updating our beliefs (n=0)
========================================================
 
![plot of chunk unnamed-chunk-4](bayesian-ab-testing-lnl-figure/unnamed-chunk-4.png) 

Changing our beliefs (n=10)
========================================================
![plot of chunk unnamed-chunk-5](bayesian-ab-testing-lnl-figure/unnamed-chunk-5.png) 

Changing our beliefs (n=20)
========================================================
![plot of chunk unnamed-chunk-6](bayesian-ab-testing-lnl-figure/unnamed-chunk-6.png) 

Changing our beliefs (n=30)
========================================================
![plot of chunk unnamed-chunk-7](bayesian-ab-testing-lnl-figure/unnamed-chunk-7.png) 

Changing our beliefs (n=40)
========================================================
![plot of chunk unnamed-chunk-8](bayesian-ab-testing-lnl-figure/unnamed-chunk-8.png) 

Changing our beliefs (n=50)
========================================================
![plot of chunk unnamed-chunk-9](bayesian-ab-testing-lnl-figure/unnamed-chunk-9.png) 

Changing our beliefs (n=100)
========================================================
![plot of chunk unnamed-chunk-10](bayesian-ab-testing-lnl-figure/unnamed-chunk-10.png) 

Changing our beliefs (n=1000)
========================================================
![plot of chunk unnamed-chunk-11](bayesian-ab-testing-lnl-figure/unnamed-chunk-11.png) 

Comparing two groups
========================================================

$$ \begin{align} \displaystyle P(\theta_B > \theta_A) &= \int \int_{\theta_B > \theta_A}P(\theta_A, \theta_B)  \\
 & = \int \int _{\theta_B > \theta_A} P(\theta_A | data) \times P(\theta_B | data) 
 \end{align}$$

![plot of chunk unnamed-chunk-12](bayesian-ab-testing-lnl-figure/unnamed-chunk-12.png) 

![plot of chunk unnamed-chunk-13](bayesian-ab-testing-lnl-figure/unnamed-chunk-13.png) 



When do we end a test?
========================================================

* **Risk:** How much many users/conversions/money do we expect we lose if we are wrong?
* Test is over as soon as the risk is below a threshold 


References
========================================================

- [Bayesian witch - Agile A/B Testing with Bayesian Statistics and Python](http://www.bayesianwitch.com/blog/2014/bayesian_ab_test.html)
- [Richrelevance - Bayesian A/B tests](http://engineering.richrelevance.com/bayesian-ab-tests/)
- [Richrelevance -  Bayesian analysis of Normal distributions with Python] (http://engineering.richrelevance.com/bayesian-analysis-of-normal-distributions-with-python/)
- [Richrelevance -  Bayesian A/B testing with a Lognormal model] (http://engineering.richrelevance.com/bayesian-ab-testing-with-a-log-normal-model/)
- [Swrve - A/B testing for game design iteration: a Bayesian approach] (http://www.gdcvault.com/play/1020201/A-B-Testing-for-Game)
- [Probabilistic Programming and Bayesian Methods for Hackers](http://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/)

